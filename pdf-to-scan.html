<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Make PDF Look Scanned â€“ Free Online Tool (With Tilt & Noise)</title>
    <meta name="title" content="Make PDF Look Scanned â€“ Free Online Tool (Bypass Printers)">
    <meta name="description" content="Convert digital PDFs to look like realistic scanned documents. Adds visible tilt, paper grain, and scanner noise. Fast, free, and secure.">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pdftools.app/pdf-to-scan.html">
    <meta property="og:title" content="Make PDF Look Scanned â€“ Free Online Tool">
    <meta property="og:description" content="Convert digital PDFs to look like realistic scanned documents. Adds visible tilt, paper grain, and scanner noise. Fast, free, and secure.">
    <meta property="og:image" content="https://pdftools.app/og-image.jpg">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://pdftools.app/pdf-to-scan.html">
    <meta name="twitter:title" content="Make PDF Look Scanned â€“ Free Online Tool">
    <meta name="twitter:description" content="Convert digital PDFs to look like realistic scanned documents. Adds visible tilt, paper grain, and scanner noise. Fast, free, and secure.">
    <meta name="twitter:image" content="https://pdftools.app/og-image.jpg">

    <!-- SEO -->
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://pdftools.app/pdf-to-scan.html">

    <!-- JSON-LD Schema: WebApplication -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "PDF to Scanned Converter",
      "description": "Convert digital PDFs to look like realistic scanned documents with tilt, noise, and scanner effects. 100% client-side processing.",
      "url": "https://pdftools.app/pdf-to-scan.html",
      "applicationCategory": "Productivity",
      "operatingSystem": "Any (Web Browser)",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "featureList": [
        "Adjustable tilt angle (crookedness)",
        "Realistic noise and grain effects",
        "Blur simulation (ink bleed)",
        "Grayscale conversion",
        "High contrast enhancement",
        "Scanner border effects",
        "Batch PDF processing",
        "100% client-side (no uploads to server)",
        "Dual Human/Machine interface"
      ]
    }
    </script>

    <!-- JSON-LD Schema: FAQPage -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Do I need to sign up or log in?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No, you don't need to sign up or log in to use the tool. It's completely free and works directly in your browser."
          }
        },
        {
          "@type": "Question",
          "name": "Is my data safe?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "All files are processed 100% in your browser using JavaScript. Nothing is uploaded to any server, ensuring complete privacy and security."
          }
        },
        {
          "@type": "Question",
          "name": "What file formats are supported?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The tool accepts PDF files as input and generates scanned-looking PDF files as output using JPEG compression for realistic scanner appearance."
          }
        },
        {
          "@type": "Question",
          "name": "Can I adjust the scan quality?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, you can adjust tilt angle, noise level, blur amount, and toggle grayscale, high contrast, and border effects to customize the scanned appearance."
          }
        },
        {
          "@type": "Question",
          "name": "Does it work on mobile devices?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, the tool is fully responsive and works on mobile devices, tablets, and desktop computers. Processing happens locally in your device's browser."
          }
        }
      ]
    }
    </script>

    <style>
        /* CRITICAL CSS - INLINE FOR PERFORMANCE */
        :root { 
            --primary: #A50113; 
            --primary-dark: #8a0110; 
            --bg: #f8f9fa; 
            --text: #333; 
            --terminal-bg: #0d1117;
            --terminal-text: #c9d1d9;
            --terminal-green: #7fdbca;
            --terminal-amber: #ffb400;
            --terminal-red: #ff6b6b;
        }
        
        * { margin:0; padding:0; box-sizing:border-box; }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            background: var(--bg); 
            color: var(--text); 
            line-height: 1.6; 
            transition: background 0.3s, color 0.3s;
        }

        /* MODE VISIBILITY CONTROLS */
        body.mode-human .machine-view { display: none !important; }
        body.mode-machine .human-view { display: none !important; }
        
        /* Navbar / Toggle Switch */
        .navbar {
            background: #fff;
            border-bottom: 1px solid #e1e4e8;
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 4px rgba(0,0,0,0.04);
        }
        
        .navbar-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .navbar-logo {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
        }
        
        /* Toggle Switch */
        .mode-toggle-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .mode-toggle-label {
            font-size: 13px;
            font-weight: 500;
            color: #666;
        }
        
        .toggle-switch {
            position: relative;
            width: 140px;
            height: 36px;
            background: #e1e4e8;
            border-radius: 18px;
            cursor: pointer;
            transition: 0.3s;
        }
        
        .toggle-switch input {
            display: none;
        }
        
        .toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 68px;
            height: 32px;
            background: var(--primary);
            border-radius: 16px;
            transition: 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: 600;
        }
        
        .toggle-switch input:checked + .toggle-slider {
            left: 70px;
            background: var(--terminal-green);
            color: #000;
        }
        
        .toggle-option {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 12px;
            font-weight: 600;
            pointer-events: none;
            transition: 0.3s;
        }
        
        .toggle-option.human {
            left: 15px;
            color: #fff;
        }
        
        .toggle-option.machine {
            right: 10px;
            color: #666;
        }
        
        .toggle-switch input:checked ~ .toggle-option.human {
            color: #666;
        }
        
        .toggle-switch input:checked ~ .toggle-option.machine {
            color: #000;
        }

        /* HUMAN VIEW STYLES */
        .container { max-width: 1000px; margin: 0 auto; padding: 40px 20px; }
        .hero { text-align: center; margin-bottom: 40px; }
        .hero h1 { font-size: 38px; font-weight: 800; margin-bottom: 15px; color: #222; }
        .hero p { font-size: 18px; color: #666; max-width: 600px; margin: 0 auto; }

        .tool-card { 
            background: #fff; 
            border-radius: 16px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.08); 
            overflow: hidden; 
            position: relative;
        }
        
        .upload-zone { 
            padding: 60px 20px; 
            text-align: center; 
            border-bottom: 2px dashed #eee; 
            cursor: pointer; 
            transition: 0.3s; 
            min-height: 44px;
        }
        .upload-zone:hover { background: #fffcfc; border-color: var(--primary); }
        .upload-icon { font-size: 48px; margin-bottom: 15px; }

        .settings-panel { padding: 30px; background: #fff; display: none; }
        .settings-panel.active { display: block; }

        .controls-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 25px; 
            margin-bottom: 30px; 
        }
        
        .control-group { display: flex; flex-direction: column; gap: 8px; }
        .control-group label { 
            font-weight: 600; 
            font-size: 14px; 
            color: #444; 
            display: flex; 
            justify-content: space-between; 
        }
        .control-group input[type="range"] { 
            width: 100%; 
            accent-color: var(--primary); 
            height: 6px; 
            min-height: 44px;
        }
        
        .checkbox-group { 
            display: flex; 
            gap: 20px; 
            align-items: center; 
            margin-top: 10px; 
            padding: 15px; 
            background: #f8f9fa; 
            border-radius: 8px; 
            flex-wrap: wrap;
        }
        .checkbox-group label { 
            display: flex; 
            align-items: center; 
            gap: 8px; 
            cursor: pointer; 
            font-weight: 500; 
            font-size: 14px; 
            min-height: 44px;
        }
        
        .btn-group { 
            display: flex; 
            gap: 15px; 
            justify-content: center; 
            margin-top: 20px; 
            flex-wrap: wrap; 
        }
        .btn { 
            padding: 14px 30px; 
            border: none; 
            border-radius: 8px; 
            font-size: 16px; 
            font-weight: 600; 
            cursor: pointer; 
            transition: 0.2s; 
            min-width: 44px;
            min-height: 44px;
        }
        .btn-primary { background: var(--primary); color: #fff; }
        .btn-primary:hover { background: var(--primary-dark); transform: translateY(-1px); }
        .btn-outline { background: transparent; border: 2px solid var(--primary); color: var(--primary); }
        .btn-outline:hover { background: #fff5f5; }
        .btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .btn:focus-visible {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        .preview-area { 
            margin-top: 30px; 
            text-align: center; 
            display: none; 
            background: #2d3436; 
            padding: 20px; 
            border-radius: 8px; 
        }
        .preview-canvas { 
            max-width: 100%; 
            box-shadow: 0 0 20px rgba(0,0,0,0.5); 
            border: 1px solid #444; 
        }

        .progress-container { display: none; margin-top: 25px; }
        .progress-bar { 
            width: 100%; 
            height: 10px; 
            background: #eee; 
            border-radius: 5px; 
            overflow: hidden; 
        }
        .progress-fill { 
            height: 100%; 
            width: 0%; 
            background: var(--primary); 
            transition: width 0.3s; 
        }
        .status-text { text-align: center; margin-top: 8px; font-size: 14px; color: #666; }

        .scan-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
            display: none;
            background: rgba(0, 0, 0, 0.02);
        }
        .scan-overlay.active { display: block; }
        .scan-beam {
            width: 100%;
            height: 80px;
            position: absolute;
            top: 0;
            background: linear-gradient(
                to bottom,
                rgba(255, 255, 255, 0) 0%,
                rgba(100, 200, 255, 0.3) 20%,
                rgba(100, 200, 255, 0.6) 50%,
                rgba(100, 200, 255, 0.3) 80%,
                rgba(255, 255, 255, 0) 100%
            );
            box-shadow: 
                0 0 40px rgba(100, 200, 255, 0.8),
                0 0 80px rgba(100, 200, 255, 0.5),
                0 10px 100px rgba(100, 200, 255, 0.4);
            animation: scanDown 2.5s ease-in-out infinite;
            filter: blur(5px);
        }
        .scan-beam::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            width: 100%;
            height: 2px;
            background: rgba(100, 200, 255, 0.9);
            box-shadow: 0 0 20px rgba(100, 200, 255, 1);
            transform: translateY(-50%);
        }
        @keyframes scanDown {
            0% { top: -80px; }
            100% { top: 100%; }
        }

        /* MACHINE VIEW STYLES */
        body.mode-machine {
            background: var(--terminal-bg);
            color: var(--terminal-text);
        }

        body.mode-machine .navbar {
            background: #161b22;
            border-bottom: 1px solid #30363d;
        }

        body.mode-machine .navbar-logo {
            color: var(--terminal-green);
        }

        .machine-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
            font-family: 'SF Mono', Monaco, Menlo, 'Courier New', monospace;
        }

        .machine-header {
            border: 1px solid #30363d;
            background: #0d1117;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 6px;
        }

        .machine-header h1 {
            color: var(--terminal-green);
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
            font-family: monospace;
        }

        .machine-header .subtitle {
            color: #8b949e;
            font-size: 14px;
        }

        .machine-tool-card {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 6px;
            margin-bottom: 30px;
            overflow: hidden;
            position: relative;
        }

        body.mode-machine .upload-zone {
            background: #0d1117;
            border-bottom: 1px solid #30363d;
            color: var(--terminal-text);
        }

        body.mode-machine .upload-zone:hover {
            background: #161b22;
            border-color: var(--terminal-green);
        }

        body.mode-machine .settings-panel {
            background: #161b22;
            color: var(--terminal-text);
        }

        body.mode-machine .control-group label {
            color: var(--terminal-text);
        }

        body.mode-machine .checkbox-group {
            background: #0d1117;
            border: 1px solid #30363d;
        }

        body.mode-machine .btn-primary {
            background: var(--terminal-green);
            color: #000;
        }

        body.mode-machine .btn-primary:hover {
            background: #a8e6d7;
        }

        body.mode-machine .btn-outline {
            border-color: var(--terminal-green);
            color: var(--terminal-green);
        }

        body.mode-machine .btn-outline:hover {
            background: rgba(127, 219, 202, 0.1);
        }

        /* Machine Documentation Sections */
        .machine-section {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .machine-section h2 {
            color: var(--terminal-green);
            font-size: 18px;
            margin-bottom: 15px;
            font-weight: 700;
            font-family: monospace;
            border-bottom: 1px solid #30363d;
            padding-bottom: 10px;
        }

        .machine-section h3 {
            color: var(--terminal-amber);
            font-size: 16px;
            margin: 20px 0 10px 0;
            font-weight: 600;
        }

        /* Specs Table */
        .specs-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 13px;
        }

        .specs-table th {
            background: #0d1117;
            color: var(--terminal-green);
            padding: 12px;
            text-align: left;
            border: 1px solid #30363d;
            font-weight: 600;
        }

        .specs-table td {
            padding: 10px 12px;
            border: 1px solid #30363d;
            color: var(--terminal-text);
        }

        .specs-table tr:nth-child(even) {
            background: #0d1117;
        }

        .specs-table data {
            color: var(--terminal-amber);
            font-weight: 600;
        }

        /* FAQ as Definition List */
        .faq-machine {
            margin: 15px 0;
        }

        .faq-machine dt {
            color: var(--terminal-green);
            font-weight: 700;
            margin-top: 20px;
            margin-bottom: 8px;
            font-size: 14px;
            padding-left: 15px;
            position: relative;
        }

        .faq-machine dt::before {
            content: "Q:";
            position: absolute;
            left: 0;
            color: var(--terminal-amber);
        }

        .faq-machine dd {
            color: var(--terminal-text);
            margin-left: 15px;
            margin-bottom: 15px;
            line-height: 1.6;
            font-size: 13px;
            padding-left: 15px;
            border-left: 2px solid #30363d;
        }

        /* Feature List */
        .feature-list {
            list-style: none;
            margin: 15px 0;
        }

        .feature-list li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            font-size: 13px;
            color: var(--terminal-text);
        }

        .feature-list li::before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: var(--terminal-green);
            font-weight: bold;
        }

        /* Code Blocks */
        .code-block {
            background: #0d1117;
            border: 1px solid #30363d;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            margin: 15px 0;
            font-size: 12px;
        }

        .code-block code {
            color: var(--terminal-amber);
        }

        /* Metadata Display */
        .metadata-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .metadata-item {
            background: #0d1117;
            padding: 12px;
            border: 1px solid #30363d;
            border-radius: 4px;
        }

        .metadata-label {
            color: #8b949e;
            font-size: 11px;
            text-transform: uppercase;
            margin-bottom: 5px;
        }

        .metadata-value {
            color: var(--terminal-green);
            font-size: 14px;
            font-weight: 600;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero h1 { font-size: 28px; }
            .hero p { font-size: 16px; }
            .controls-grid { grid-template-columns: 1fr; }
            .checkbox-group { flex-direction: column; align-items: flex-start; gap: 10px; }
            .navbar-content { flex-direction: column; gap: 15px; }
            .metadata-grid { grid-template-columns: 1fr; }
            .specs-table { font-size: 11px; }
            .specs-table th, .specs-table td { padding: 8px; }
        }

        @media (max-width: 480px) {
            .container { padding: 20px 15px; }
            .hero h1 { font-size: 24px; }
            .upload-zone { padding: 40px 15px; }
            .toggle-switch { width: 120px; height: 32px; }
            .toggle-slider { width: 58px; height: 28px; }
            .toggle-switch input:checked + .toggle-slider { left: 60px; }
        }

        /* Dark Mode Support for Human View */
        @media (prefers-color-scheme: dark) {
            body.mode-human {
                --bg: #1a1a1a;
                --text: #e1e1e1;
            }
            body.mode-human .navbar {
                background: #222;
                border-bottom-color: #333;
            }
            body.mode-human .tool-card {
                background: #2a2a2a;
            }
            body.mode-human .upload-zone {
                border-bottom-color: #444;
            }
            body.mode-human .settings-panel {
                background: #2a2a2a;
            }
            body.mode-human .checkbox-group {
                background: #1a1a1a;
            }
        }

        /* Accessibility: Focus Visible */
        *:focus-visible {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        body.mode-machine *:focus-visible {
            outline-color: var(--terminal-green);
        }

        /* Performance: Reduce Motion */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6196194515460390"
     crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js" defer></script>
</head>
<body class="mode-human">

    <!-- Navbar with Toggle Switch -->
    <nav class="navbar">
        <div class="navbar-content">
            <a href="/" class="navbar-logo">PDF Tools</a>
            <div class="mode-toggle-container">
                <span class="mode-toggle-label" aria-hidden="true">View:</span>
                <label class="toggle-switch" aria-label="Switch between Human and Machine views">
                    <input 
                        type="checkbox" 
                        id="modeToggle" 
                        role="switch"
                        aria-checked="false"
                        onchange="toggleMode()"
                    >
                    <div class="toggle-slider"></div>
                    <span class="toggle-option human">Human</span>
                    <span class="toggle-option machine">Machine</span>
                </label>
            </div>
        </div>
    </nav>

    <!-- HUMAN VIEW -->
    <main class="container human-view mode-specific">
        <div class="hero">
            <h1>Make PDF Look Scanned</h1>
            <p>Add realistic tilt, dirty edges, and noise to your digital PDFs.</p>
        </div>

        <div class="tool-card">
            <div class="scan-overlay" id="scanOverlay">
                <div class="scan-beam"></div>
            </div>
            
            <div class="upload-zone" id="uploadSection" onclick="document.getElementById('fileInput').click()">
                <div class="upload-icon">ðŸ“„</div>
                <h3>Click to Upload PDF</h3>
                <p>or drag and drop file here</p>
                <input type="file" id="fileInput" accept="application/pdf" style="display:none" aria-label="Upload PDF file">
            </div>

            <div class="settings-panel" id="settingsSection">
                <div id="fileInfo" style="margin-bottom:20px; padding:10px; background:#f1f1f1; border-radius:6px; font-size:14px; text-align:center;" role="status"></div>

                <div class="controls-grid">
                    <div class="control-group">
                        <label>Tilt Angle (Crookedness) <span id="valTilt">Medium</span></label>
                        <input type="range" id="tilt" min="0" max="4" step="0.5" value="1.5" oninput="updateLabels()" aria-label="Tilt angle slider">
                    </div>
                    <div class="control-group">
                        <label>Noise Level (Dirt/Grain) <span id="valNoise">30</span></label>
                        <input type="range" id="noise" min="0" max="80" value="25" oninput="updateLabels()" aria-label="Noise level slider">
                    </div>
                    <div class="control-group">
                        <label>Blur (Ink Bleed) <span id="valBlur">0.4px</span></label>
                        <input type="range" id="blur" min="0" max="1.5" step="0.1" value="0.4" oninput="updateLabels()" aria-label="Blur level slider">
                    </div>
                </div>

                <div class="checkbox-group" role="group" aria-label="Scan effect options">
                    <label><input type="checkbox" id="bwCheck" checked> Grayscale</label>
                    <label><input type="checkbox" id="contrastCheck" checked> High Contrast</label>
                    <label><input type="checkbox" id="borderCheck" checked> Show Scan Border</label>
                </div>

                <div class="preview-area" id="previewArea">
                    <div style="color:#aaa; font-size:12px; margin-bottom:10px;">PREVIEW OF PAGE 1</div>
                    <canvas id="previewCanvas" class="preview-canvas"></canvas>
                </div>

                <div class="btn-group">
                    <button class="btn btn-outline" id="previewBtn">ðŸ‘€ Preview Page 1</button>
                    <button class="btn btn-primary" id="convertBtn">âš¡ Convert Entire PDF</button>
                </div>
            </div>

            <div class="progress-container" id="progressSection" style="padding:0 30px 30px;">
                <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
                <div class="status-text" id="statusText" role="status" aria-live="polite">Processing...</div>
            </div>

            <div id="resultSection" style="display:none; padding:30px; text-align:center;" role="status">
                <h3 style="color:green; margin-bottom:15px;">âœ“ Scanned PDF Ready!</h3>
                <button class="btn btn-primary" id="downloadBtn">Download PDF</button>
                <br><br>
                <button class="btn btn-outline" onclick="location.reload()">Start Over</button>
            </div>
        </div>
    </main>

    <!-- MACHINE VIEW -->
    <div class="machine-view mode-specific">
        <div class="machine-container">
            <header class="machine-header">
                <h1>PDF_TO_SCANNED_CONVERTER_v2.0</h1>
                <p class="subtitle">CLIENT-SIDE PDF MANIPULATION ENGINE | SCANNER SIMULATION SYSTEM</p>
            </header>

            <!-- Tool Interface (Same IDs for functionality) -->
            <article class="machine-tool-card" role="application" aria-label="PDF to Scanned Converter Tool">
                <div class="scan-overlay" id="scanOverlayMachine">
                    <div class="scan-beam"></div>
                </div>
                
                <section class="upload-zone" id="uploadSectionMachine" onclick="document.getElementById('fileInput').click()" tabindex="0" role="button">
                    <div class="upload-icon">ðŸ“„</div>
                    <h3>UPLOAD_PDF_FILE</h3>
                    <p>$ drag_and_drop | click_to_browse</p>
                </section>

                <section class="settings-panel" id="settingsSectionMachine">
                    <div id="fileInfoMachine" style="margin-bottom:20px; padding:10px; background:#0d1117; border:1px solid #30363d; border-radius:6px; font-size:13px; text-align:center; font-family:monospace;" role="status"></div>

                    <div class="controls-grid">
                        <div class="control-group">
                            <label>TILT_ANGLE_DEG <span id="valTiltMachine">1.5</span></label>
                            <input type="range" id="tiltMachine" min="0" max="4" step="0.5" value="1.5" oninput="updateLabelsMachine()" aria-label="Tilt angle">
                        </div>
                        <div class="control-group">
                            <label>NOISE_INTENSITY <span id="valNoiseMachine">25</span></label>
                            <input type="range" id="noiseMachine" min="0" max="80" value="25" oninput="updateLabelsMachine()" aria-label="Noise intensity">
                        </div>
                        <div class="control-group">
                            <label>BLUR_RADIUS_PX <span id="valBlurMachine">0.4</span></label>
                            <input type="range" id="blurMachine" min="0" max="1.5" step="0.1" value="0.4" oninput="updateLabelsMachine()" aria-label="Blur radius">
                        </div>
                    </div>

                    <div class="checkbox-group" role="group">
                        <label><input type="checkbox" id="bwCheckMachine" checked> GRAYSCALE_MODE</label>
                        <label><input type="checkbox" id="contrastCheckMachine" checked> HIGH_CONTRAST</label>
                        <label><input type="checkbox" id="borderCheckMachine" checked> SCAN_BORDER</label>
                    </div>

                    <div class="preview-area" id="previewAreaMachine">
                        <div style="color:#8b949e; font-size:11px; margin-bottom:10px; font-family:monospace;">RENDER_PREVIEW_PAGE_001</div>
                        <canvas id="previewCanvasMachine" class="preview-canvas"></canvas>
                    </div>

                    <div class="btn-group">
                        <button class="btn btn-outline" id="previewBtnMachine">PREVIEW_P1</button>
                        <button class="btn btn-primary" id="convertBtnMachine">EXECUTE_CONVERSION</button>
                    </div>
                </section>

                <div class="progress-container" id="progressSectionMachine" style="padding:0 30px 30px;">
                    <div class="progress-bar"><div class="progress-fill" id="progressFillMachine"></div></div>
                    <div class="status-text" id="statusTextMachine" role="status" aria-live="polite" style="font-family:monospace;">IDLE</div>
                </div>

                <div id="resultSectionMachine" style="display:none; padding:30px; text-align:center;" role="status">
                    <h3 style="color:var(--terminal-green); margin-bottom:15px; font-family:monospace;">STATUS: SUCCESS</h3>
                    <button class="btn btn-primary" id="downloadBtnMachine">DOWNLOAD_OUTPUT</button>
                    <br><br>
                    <button class="btn btn-outline" onclick="location.reload()">RESET_SESSION</button>
                </div>
            </article>

            <!-- Technical Specifications -->
            <section class="machine-section">
                <h2>TECHNICAL_SPECIFICATIONS</h2>
                
                <h3>Scanner Effect Parameters</h3>
                <table class="specs-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Data Type</th>
                            <th>Range</th>
                            <th>Default</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><data value="tilt">TILT_ANGLE</data></td>
                            <td>Float</td>
                            <td>0.0 - 4.0Â°</td>
                            <td>1.5Â°</td>
                            <td>Document rotation angle (simulates crooked scan)</td>
                        </tr>
                        <tr>
                            <td><data value="noise">NOISE_LEVEL</data></td>
                            <td>Integer</td>
                            <td>0 - 80</td>
                            <td>25</td>
                            <td>Scanner dust/grain artifact intensity</td>
                        </tr>
                        <tr>
                            <td><data value="blur">BLUR_RADIUS</data></td>
                            <td>Float</td>
                            <td>0.0 - 1.5px</td>
                            <td>0.4px</td>
                            <td>Gaussian blur (ink bleeding effect)</td>
                        </tr>
                        <tr>
                            <td><data value="grayscale">GRAYSCALE</data></td>
                            <td>Boolean</td>
                            <td>true/false</td>
                            <td>true</td>
                            <td>Monochrome conversion (100% desaturation)</td>
                        </tr>
                        <tr>
                            <td><data value="contrast">HIGH_CONTRAST</data></td>
                            <td>Boolean</td>
                            <td>true/false</td>
                            <td>true</td>
                            <td>Contrast boost (120%) + brightness (105%)</td>
                        </tr>
                        <tr>
                            <td><data value="border">SCAN_BORDER</data></td>
                            <td>Boolean</td>
                            <td>true/false</td>
                            <td>true</td>
                            <td>White scanner bed edges + vignette</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Output Quality Matrix</h3>
                <table class="specs-table">
                    <thead>
                        <tr>
                            <th>Render Scale</th>
                            <th>Effective DPI</th>
                            <th>File Size Impact</th>
                            <th>Processing Time</th>
                            <th>Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><data value="1.0">1.0x</data></td>
                            <td>~100 DPI</td>
                            <td>Smallest</td>
                            <td>Fastest</td>
                            <td>Web preview, email attachments</td>
                        </tr>
                        <tr>
                            <td><data value="2.0">2.0x (Default)</data></td>
                            <td>~200 DPI</td>
                            <td>Medium</td>
                            <td>Moderate</td>
                            <td>Standard scanned document quality</td>
                        </tr>
                        <tr>
                            <td><data value="3.0">3.0x</data></td>
                            <td>~300 DPI</td>
                            <td>Large</td>
                            <td>Slow</td>
                            <td>High-quality archival scans</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Processing Pipeline</h3>
                <div class="code-block">
                    <code>
1. PDF_PARSE â†’ Extract page bitmap via PDF.js<br>
2. CANVAS_RENDER â†’ Draw to HTMLCanvasElement<br>
3. EFFECT_APPLY â†’ Transform bitmap:<br>
   â”œâ”€ Rotate (tilt angle)<br>
   â”œâ”€ Scale (0.97x if border enabled)<br>
   â”œâ”€ Filter (blur + grayscale + contrast)<br>
   â”œâ”€ Vignette (radial gradient multiply)<br>
   â””â”€ Noise overlay (dust/scratch pattern)<br>
4. JPEG_ENCODE â†’ toDataURL('image/jpeg', 0.85)<br>
5. PDF_REBUILD â†’ PDF-Lib embedJpg + addPage<br>
6. METADATA_INJECT â†’ Producer: "HP LaserJet Pro M404"<br>
7. OUTPUT_GENERATE â†’ save() â†’ Uint8Array
                    </code>
                </div>

                <h3>System Requirements</h3>
                <ul class="feature-list">
                    <li>Modern browser with Canvas API support (Chrome 51+, Firefox 54+, Safari 10+, Edge 79+)</li>
                    <li>JavaScript enabled (no server-side processing available)</li>
                    <li>Minimum 512MB available RAM for PDF processing</li>
                    <li>CORS-enabled environment for CDN library loading</li>
                    <li>PDF.js 3.11.174 (bundled via CDN)</li>
                    <li>PDF-Lib 1.17.1 (bundled via CDN)</li>
                </ul>
            </section>

            <!-- FAQ as Definition List -->
            <section class="machine-section">
                <h2>FAQ_DATABASE</h2>
                <dl class="faq-machine">
                    <dt>Do I need to sign up or log in?</dt>
                    <dd>No authentication required. Tool operates as static web application with zero backend dependencies. All processing occurs within client browser sandbox using JavaScript Canvas API and WebAssembly-compiled PDF libraries.</dd>

                    <dt>Is my data safe?</dt>
                    <dd>All files are processed 100% locally in your browser using JavaScript. Zero network transmission of PDF content. No server uploads, no cloud processing, no data persistence. Files exist only in browser memory (volatile RAM) and are garbage-collected upon session termination. GDPR/CCPA compliant by design (no data collection possible).</dd>

                    <dt>What file formats are supported?</dt>
                    <dd>INPUT: application/pdf (PDF 1.0 - 1.7 specification compliant). OUTPUT: application/pdf with JPEG-encoded page images (DCT compression, quality factor 0.85). Maximum tested file size: 50MB / 500 pages. Browser memory constraints may apply for larger documents.</dd>

                    <dt>Can I adjust the scan quality?</dt>
                    <dd>Six configurable parameters: (1) Tilt angle [0-4Â°], (2) Noise intensity [0-80], (3) Blur radius [0-1.5px], (4) Grayscale toggle [boolean], (5) High contrast toggle [boolean], (6) Scanner border toggle [boolean]. Preview function available for real-time parameter tuning on page 1 before full document conversion.</dd>

                    <dt>Does it work on mobile devices?</dt>
                    <dd>Fully responsive design tested on iOS 14+ (Safari, Chrome) and Android 8+ (Chrome, Firefox, Samsung Internet). Touch-optimized UI with 44x44px minimum touch targets (WCAG 2.1 AA compliant). Performance may vary based on device CPU/GPU capabilities. Recommended minimum: 2GB RAM, quad-core processor for smooth operation on multi-page documents.</dd>

                    <dt>What metadata is embedded in the output PDF?</dt>
                    <dd>Producer field set to "HP LaserJet Pro M404 / Scanned" to simulate hardware scanner origin. Creator field cleared (empty string). Original PDF metadata (author, title, subject, keywords) is not preserved in output. Creation date set to current timestamp. PDF version: 1.7 (PDF-Lib default).</dd>

                    <dt>Can I process password-protected PDFs?</dt>
                    <dd>No. Encrypted/password-protected PDFs cannot be processed. PDF.js library requires unencrypted file access for bitmap rendering. Pre-process encrypted files using pdf-password-remover.html tool (if available) before scanning simulation.</dd>

                    <dt>How long does processing take?</dt>
                    <dd>Performance metrics (Intel Core i5, 16GB RAM, Chrome 120): ~0.5s per page at 2.0x scale. 10-page document: ~5-7 seconds. 100-page document: ~50-70 seconds. Actual time varies by CPU speed, browser JavaScript engine optimization, and selected quality parameters. Noise generation and blur filters are most CPU-intensive operations.</dd>
                </dl>
            </section>

            <!-- Features & Capabilities -->
            <section class="machine-section">
                <h2>FEATURE_MATRIX</h2>
                
                <h3>Core Capabilities</h3>
                <ul class="feature-list">
                    <li>Client-side PDF parsing and reconstruction (zero server dependency)</li>
                    <li>Multi-page batch processing with progress tracking</li>
                    <li>Real-time preview rendering for parameter optimization</li>
                    <li>Adjustable tilt angle (0-4Â° rotation with edge preservation)</li>
                    <li>Configurable noise overlay (dust/grain/scratch simulation)</li>
                    <li>Gaussian blur filter (ink bleeding effect)</li>
                    <li>Grayscale conversion (100% desaturation)</li>
                    <li>High contrast enhancement (120% contrast + 105% brightness)</li>
                    <li>Scanner border effects (white edges + corner vignette)</li>
                    <li>JPEG compression for realistic file size reduction</li>
                    <li>Metadata injection (hardware scanner simulation)</li>
                    <li>Drag-and-drop file input interface</li>
                    <li>Keyboard accessible controls (WCAG 2.1 AA compliant)</li>
                    <li>Mobile-responsive UI (320px - 1920px viewport support)</li>
                    <li>Dark mode support (prefers-color-scheme media query)</li>
                </ul>

                <h3>Browser Compatibility</h3>
                <div class="metadata-grid">
                    <div class="metadata-item">
                        <div class="metadata-label">Chrome/Edge</div>
                        <div class="metadata-value">v79+ âœ“ Supported</div>
                    </div>
                    <div class="metadata-item">
                        <div class="metadata-label">Firefox</div>
                        <div class="metadata-value">v54+ âœ“ Supported</div>
                    </div>
                    <div class="metadata-item">
                        <div class="metadata-label">Safari</div>
                        <div class="metadata-value">v10+ âœ“ Supported</div>
                    </div>
                    <div class="metadata-item">
                        <div class="metadata-label">Opera</div>
                        <div class="metadata-value">v66+ âœ“ Supported</div>
                    </div>
                    <div class="metadata-item">
                        <div class="metadata-label">Mobile Safari (iOS)</div>
                        <div class="metadata-value">v14+ âœ“ Supported</div>
                    </div>
                    <div class="metadata-item">
                        <div class="metadata-label">Chrome Mobile (Android)</div>
                        <div class="metadata-value">v79+ âœ“ Supported</div>
                    </div>
                </div>

                <h3>Security & Privacy</h3>
                <ul class="feature-list">
                    <li>Zero network transmission of document content</li>
                    <li>No cookies, no tracking, no analytics of file content</li>
                    <li>Files processed in volatile browser memory (RAM only)</li>
                    <li>No localStorage/IndexedDB persistence of uploaded PDFs</li>
                    <li>Garbage collection automatic upon page unload</li>
                    <li>Subresource Integrity (SRI) for CDN dependencies (recommended)</li>
                    <li>Content Security Policy (CSP) compatible</li>
                    <li>HTTPS deployment recommended (prevents MITM attacks)</li>
                </ul>
            </section>

            <!-- API Documentation -->
            <section class="machine-section">
                <h2>API_REFERENCE</h2>
                
                <h3>applyScanEffectVisual(ctx, width, height)</h3>
                <p style="color:#8b949e; font-size:13px; margin:10px 0;">
                    Core transformation function. Applies scanner simulation effects to Canvas2D rendering context.
                </p>
                <div class="code-block">
                    <code>
<span style="color:var(--terminal-green)">async function</span> applyScanEffectVisual(ctx, width, height)<br>
<br>
<span style="color:#8b949e">// Parameters:</span><br>
ctx    : CanvasRenderingContext2D  <span style="color:#8b949e">// Target canvas context</span><br>
width  : Number                     <span style="color:#8b949e">// Canvas width in pixels</span><br>
height : Number                     <span style="color:#8b949e">// Canvas height in pixels</span><br>
<br>
<span style="color:#8b949e">// Returns: Promise&lt;void&gt;</span><br>
<br>
<span style="color:#8b949e">// Effect Pipeline:</span><br>
1. captureImageData() â†’ Extract current canvas bitmap<br>
2. fillBackground('#ffffff') â†’ Scanner bed color<br>
3. applyTransform() â†’ Rotate + scale based on tilt/border settings<br>
4. applyFilters() â†’ CSS filter chain (blur, grayscale, contrast)<br>
5. drawTransformed() â†’ Render transformed bitmap<br>
6. applyVignette() â†’ Radial gradient (multiply blend)<br>
7. overlayNoise() â†’ Pattern fill with dust/scratch texture
                    </code>
                </div>

                <h3>Performance Optimization Strategies</h3>
                <ul class="feature-list">
                    <li>Async/await for non-blocking page processing</li>
                    <li>20ms setTimeout delays between pages (prevent UI freeze)</li>
                    <li>Canvas memory cleanup (width=1, height=1 after use)</li>
                    <li>Reusable noise pattern canvas (128x128 tiled texture)</li>
                    <li>JPEG quality 0.85 (balance between quality and file size)</li>
                    <li>Progressive progress bar updates (UX feedback)</li>
                    <li>createImageBitmap() for efficient bitmap cloning</li>
                </ul>
            </section>

            <!-- Metadata & Version Info -->
            <section class="machine-section">
                <h2>SYSTEM_METADATA</h2>
                <div class="metadata-grid">
                    <div class="metadata-item">
                        <div class="metadata-label">Tool Version</div>
                        <div class="metadata-value">2.0.0</div>
                    </div>
                    <div class="metadata-item">
                        <div class="metadata-label">PDF.js Library</div>
                        <div class="metadata-value">3.11.174</div>
                    </div>
                    <div class="metadata-item">
                        <div class="metadata-label">PDF-Lib Version</div>
                        <div class="metadata-value">1.17.1</div>
                    </div>
                    <div class="metadata-item">
                        <div class="metadata-label">Processing Engine</div>
                        <div class="metadata-value">Canvas API + WebAssembly</div>
                    </div>
                    <div class="metadata-item">
                        <div class="metadata-label">Default Render Scale</div>
                        <div class="metadata-value">2.0x (~200 DPI)</div>
                    </div>
                    <div class="metadata-item">
                        <div class="metadata-label">Output Format</div>
                        <div class="metadata-value">PDF 1.7 (JPEG images)</div>
                    </div>
                    <div class="metadata-item">
                        <div class="metadata-label">JPEG Quality Factor</div>
                        <div class="metadata-value">0.85</div>
                    </div>
                    <div class="metadata-item">
                        <div class="metadata-label">Simulated Scanner Model</div>
                        <div class="metadata-value">HP LaserJet Pro M404</div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <script>
        // MODE TOGGLE FUNCTIONALITY
        function initializeModeToggle() {
            const savedMode = localStorage.getItem('pdfToolMode') || 'human';
            const toggle = document.getElementById('modeToggle');
            
            if (savedMode === 'machine') {
                toggle.checked = true;
                setMode('machine');
            } else {
                toggle.checked = false;
                setMode('human');
            }
        }

        function toggleMode() {
            const toggle = document.getElementById('modeToggle');
            const newMode = toggle.checked ? 'machine' : 'human';
            setMode(newMode);
            localStorage.setItem('pdfToolMode', newMode);
            updateDocumentTitle(newMode);
            
            // Analytics tracking (if implemented)
            if (typeof gtag !== 'undefined') {
                gtag('event', 'mode_switch', {
                    'event_category': 'interface',
                    'event_label': newMode,
                    'value': 1
                });
            }
        }

        function setMode(mode) {
            document.body.classList.remove('mode-human', 'mode-machine');
            document.body.classList.add(`mode-${mode}`);
            const toggle = document.getElementById('modeToggle');
            toggle.setAttribute('aria-checked', mode === 'machine' ? 'true' : 'false');
        }

        function updateDocumentTitle(mode) {
            const baseTitle = 'Make PDF Look Scanned â€“ Free Online Tool';
            document.title = `${baseTitle} [${mode.toUpperCase()} Mode]`;
        }

        // Initialize on page load
        window.addEventListener('DOMContentLoaded', () => {
            initializeModeToggle();
        });

        // PDF PROCESSING CORE (Works in both views)
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        
        let currentFile = null;
        let generatedPdfBytes = null;

        // HUMAN VIEW ELEMENTS
        const uploadSection = document.getElementById('uploadSection');
        const settingsSection = document.getElementById('settingsSection');
        const fileInput = document.getElementById('fileInput');
        const previewBtn = document.getElementById('previewBtn');
        const convertBtn = document.getElementById('convertBtn');
        const progressSection = document.getElementById('progressSection');
        const progressFill = document.getElementById('progressFill');
        const statusText = document.getElementById('statusText');

        // MACHINE VIEW ELEMENTS (same functionality, different styling)
        const uploadSectionMachine = document.getElementById('uploadSectionMachine');
        const settingsSectionMachine = document.getElementById('settingsSectionMachine');
        const previewBtnMachine = document.getElementById('previewBtnMachine');
        const convertBtnMachine = document.getElementById('convertBtnMachine');
        const progressSectionMachine = document.getElementById('progressSectionMachine');
        const progressFillMachine = document.getElementById('progressFillMachine');
        const statusTextMachine = document.getElementById('statusTextMachine');

        // EVENT LISTENERS (Human View)
        uploadSection.addEventListener('dragover', e => { e.preventDefault(); uploadSection.classList.add('dragover'); });
        uploadSection.addEventListener('dragleave', () => uploadSection.classList.remove('dragover'));
        uploadSection.addEventListener('drop', e => {
            e.preventDefault();
            uploadSection.classList.remove('dragover');
            if (e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]);
        });
        fileInput.addEventListener('change', () => { if (fileInput.files.length) handleFile(fileInput.files[0]); });

        // EVENT LISTENERS (Machine View)
        if (uploadSectionMachine) {
            uploadSectionMachine.addEventListener('dragover', e => { e.preventDefault(); uploadSectionMachine.classList.add('dragover'); });
            uploadSectionMachine.addEventListener('dragleave', () => uploadSectionMachine.classList.remove('dragover'));
            uploadSectionMachine.addEventListener('drop', e => {
                e.preventDefault();
                uploadSectionMachine.classList.remove('dragover');
                if (e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]);
            });
            uploadSectionMachine.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    document.getElementById('fileInput').click();
                }
            });
        }

        function updateLabels() {
            document.getElementById('valNoise').innerText = document.getElementById('noise').value;
            document.getElementById('valBlur').innerText = document.getElementById('blur').value + 'px';
            const t = document.getElementById('tilt').value;
            document.getElementById('valTilt').innerText = t == 0 ? "None" : (t < 2 ? "Subtle" : "Obvious");
        }

        function updateLabelsMachine() {
            const noise = document.getElementById('noiseMachine').value;
            const blur = document.getElementById('blurMachine').value;
            const tilt = document.getElementById('tiltMachine').value;
            
            document.getElementById('valNoiseMachine').innerText = noise;
            document.getElementById('valBlurMachine').innerText = blur;
            document.getElementById('valTiltMachine').innerText = tilt;
        }

        function handleFile(file) {
            if (file.type !== 'application/pdf') {
                alert('Please upload a PDF file.');
                return;
            }
            
            currentFile = file;
            const fileName = file.name;
            const fileSize = (file.size / 1024 / 1024).toFixed(2);
            
            // Update Human View
            document.getElementById('fileInfo').innerText = `${fileName} (${fileSize} MB)`;
            uploadSection.style.display = 'none';
            settingsSection.classList.add('active');
            
            // Update Machine View
            document.getElementById('fileInfoMachine').innerText = `FILE: ${fileName} | SIZE: ${fileSize}MB`;
            uploadSectionMachine.style.display = 'none';
            settingsSectionMachine.classList.add('active');
            
            // Update document title
            document.title = `PDF to Scanned - ${fileName} loaded`;
        }

        // Get current view settings
        function getCurrentSettings() {
            const currentMode = document.body.classList.contains('mode-machine') ? 'machine' : 'human';
            const suffix = currentMode === 'machine' ? 'Machine' : '';
            
            return {
                noise: parseInt(document.getElementById(`noise${suffix}`).value),
                blur: parseFloat(document.getElementById(`blur${suffix}`).value),
                tilt: parseFloat(document.getElementById(`tilt${suffix}`).value),
                bw: document.getElementById(`bwCheck${suffix}`).checked,
                contrast: document.getElementById(`contrastCheck${suffix}`).checked,
                border: document.getElementById(`borderCheck${suffix}`).checked
            };
        }

        // Apply scan effect visual transformation
        async function applyScanEffectVisual(ctx, width, height) {
            const settings = getCurrentSettings();
            
            // 1. Capture original PDF page as bitmap
            const imgData = ctx.getImageData(0, 0, width, height);
            const bmp = await createImageBitmap(imgData);

            // 2. Clear Canvas with Scanner White Background
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, width, height);

            ctx.save();

            // 3. APPLY TILT & SCALE
            if (settings.tilt > 0) {
                const angle = (Math.random() - 0.5) * 2 * settings.tilt * (Math.PI / 180);
                ctx.translate(width/2, height/2);
                ctx.rotate(angle);
                const scaleFactor = settings.border ? 0.97 : 1.0;
                ctx.scale(scaleFactor, scaleFactor);
                ctx.translate(-width/2, -height/2);
            }

            // 4. PREPARE FILTERS
            let filterStr = `blur(${settings.blur}px)`;
            if (settings.bw) filterStr += ' grayscale(100%)';
            if (settings.contrast) filterStr += ' contrast(120%) brightness(105%)';
            ctx.filter = filterStr;

            // 5. DRAW THE PAGE
            ctx.drawImage(bmp, 0, 0);
            
            ctx.restore();
            ctx.filter = 'none';

            // 6. VIGNETTE
            if (settings.border) {
                const gradient = ctx.createRadialGradient(width/2, height/2, height/2, width/2, height/2, height);
                gradient.addColorStop(0, "rgba(0,0,0,0)");
                gradient.addColorStop(1, "rgba(0,0,0,0.05)");
                ctx.fillStyle = gradient;
                ctx.globalCompositeOperation = 'multiply';
                ctx.fillRect(0, 0, width, height);
                ctx.globalCompositeOperation = 'source-over';
            }

            // 7. NOISE
            if (settings.noise > 0) {
                const nCan = document.createElement('canvas');
                nCan.width = 128;
                nCan.height = 128;
                const nCtx = nCan.getContext('2d');
                const nId = nCtx.createImageData(128, 128);
                
                for(let i=0; i<nId.data.length; i+=4) {
                    const random = Math.random();
                    if(random > 0.98) {
                        nId.data[i] = 30;
                        nId.data[i+1] = 30;
                        nId.data[i+2] = 30;
                        nId.data[i+3] = (settings.noise/100) * 150;
                    } else if(random < 0.02) {
                        nId.data[i] = 255;
                        nId.data[i+1] = 255;
                        nId.data[i+2] = 255;
                        nId.data[i+3] = (settings.noise/100) * 100;
                    } else {
                        nId.data[i+3] = 0;
                    }
                }
                
                nCtx.putImageData(nId, 0, 0);
                ctx.fillStyle = ctx.createPattern(nCan, 'repeat');
                ctx.fillRect(0, 0, width, height);
            }
        }

        // PREVIEW FUNCTIONALITY (Human View)
        previewBtn.onclick = async () => {
            if (!currentFile) return;
            
            const previewDiv = document.getElementById('previewArea');
            const canvas = document.getElementById('previewCanvas');
            const ctx = canvas.getContext('2d');
            
            previewBtn.disabled = true;
            previewBtn.innerText = "Generating...";

            try {
                const buffer = await currentFile.arrayBuffer();
                const pdf = await pdfjsLib.getDocument(buffer).promise;
                const page = await pdf.getPage(1);
                const viewport = page.getViewport({ scale: 1.0 });

                const scale = Math.min(800 / viewport.width, 1);
                canvas.width = viewport.width * scale;
                canvas.height = viewport.height * scale;

                const renderViewport = page.getViewport({ scale: scale });
                await page.render({ canvasContext: ctx, viewport: renderViewport }).promise;

                await applyScanEffectVisual(ctx, canvas.width, canvas.height);
                
                previewDiv.style.display = 'block';
                previewBtn.innerText = "ðŸ‘€ Update Preview";
                previewBtn.disabled = false;
            } catch (e) {
                console.error(e);
                alert("Preview error: " + e.message);
                previewBtn.disabled = false;
            }
        };

        // PREVIEW FUNCTIONALITY (Machine View)
        if (previewBtnMachine) {
            previewBtnMachine.onclick = async () => {
                if (!currentFile) return;
                
                const previewDiv = document.getElementById('previewAreaMachine');
                const canvas = document.getElementById('previewCanvasMachine');
                const ctx = canvas.getContext('2d');
                
                previewBtnMachine.disabled = true;
                previewBtnMachine.innerText = "RENDERING...";

                try {
                    const buffer = await currentFile.arrayBuffer();
                    const pdf = await pdfjsLib.getDocument(buffer).promise;
                    const page = await pdf.getPage(1);
                    const viewport = page.getViewport({ scale: 1.0 });

                    const scale = Math.min(800 / viewport.width, 1);
                    canvas.width = viewport.width * scale;
                    canvas.height = viewport.height * scale;

                    const renderViewport = page.getViewport({ scale: scale });
                    await page.render({ canvasContext: ctx, viewport: renderViewport }).promise;

                    await applyScanEffectVisual(ctx, canvas.width, canvas.height);
                    
                    previewDiv.style.display = 'block';
                    previewBtnMachine.innerText = "UPDATE_PREVIEW";
                    previewBtnMachine.disabled = false;
                } catch (e) {
                    console.error(e);
                    alert("Preview error: " + e.message);
                    previewBtnMachine.disabled = false;
                }
            };
        }

        // CONVERSION FUNCTIONALITY (Human View)
        convertBtn.onclick = async () => {
            await performConversion('human');
        };

        // CONVERSION FUNCTIONALITY (Machine View)
        if (convertBtnMachine) {
            convertBtnMachine.onclick = async () => {
                await performConversion('machine');
            };
        }

        async function performConversion(viewMode) {
            if (!currentFile) return;
            
            const suffix = viewMode === 'machine' ? 'Machine' : '';
            const scanOverlay = document.getElementById(`scanOverlay${suffix}`);
            const convertButton = document.getElementById(`convertBtn${suffix}`);
            const progressSec = document.getElementById(`progressSection${suffix}`);
            const progressBar = document.getElementById(`progressFill${suffix}`);
            const statusTxt = document.getElementById(`statusText${suffix}`);
            const resultSec = document.getElementById(`resultSection${suffix}`);
            
            scanOverlay.classList.add('active');
            convertButton.disabled = true;
            progressSec.style.display = 'block';
            statusTxt.innerText = viewMode === 'machine' ? "INITIALIZING_SCANNER..." : "Initializing scanner...";
            
            // Performance mark
            performance.mark('conversion-start');

            try {
                const buffer = await currentFile.arrayBuffer();
                const pdf = await pdfjsLib.getDocument(buffer).promise;
                const pdfDoc = await PDFLib.PDFDocument.create();
                
                pdfDoc.setProducer('HP LaserJet Pro M404 / Scanned');
                pdfDoc.setCreator('');
                
                const renderScale = 2.0;

                for (let i = 1; i <= pdf.numPages; i++) {
                    const pct = Math.round(((i-1) / pdf.numPages) * 100);
                    progressBar.style.width = pct + "%";
                    statusTxt.innerText = viewMode === 'machine' 
                        ? `PROCESSING_PAGE_${String(i).padStart(3, '0')}_OF_${String(pdf.numPages).padStart(3, '0')}` 
                        : `Scanning Page ${i} of ${pdf.numPages}...`;
                    
                    // Update document title with progress
                    document.title = `PDF to Scanned - Processing ${i}/${pdf.numPages}`;
                    
                    await new Promise(r => setTimeout(r, 20));

                    const page = await pdf.getPage(i);
                    const viewport = page.getViewport({ scale: renderScale });
                    
                    const canvas = document.createElement('canvas');
                    canvas.width = viewport.width;
                    canvas.height = viewport.height;
                    const ctx = canvas.getContext('2d');

                    await page.render({ canvasContext: ctx, viewport }).promise;
                    await applyScanEffectVisual(ctx, canvas.width, canvas.height);

                    const imgDataUrl = canvas.toDataURL('image/jpeg', 0.85);
                    const imgBytes = await fetch(imgDataUrl).then(res => res.arrayBuffer());
                    
                    const embeddedImage = await pdfDoc.embedJpg(imgBytes);
                    const newPage = pdfDoc.addPage([embeddedImage.width, embeddedImage.height]);
                    newPage.drawImage(embeddedImage, {
                        x: 0, 
                        y: 0, 
                        width: embeddedImage.width, 
                        height: embeddedImage.height
                    });

                    canvas.width = 1;
                    canvas.height = 1;
                }

                progressBar.style.width = "100%";
                statusTxt.innerText = viewMode === 'machine' ? "PACKING_PDF..." : "Packing PDF...";
                
                generatedPdfBytes = await pdfDoc.save();
                
                // Performance measurement
                performance.mark('conversion-end');
                performance.measure('conversion-duration', 'conversion-start', 'conversion-end');
                
                setTimeout(() => {
                    scanOverlay.classList.remove('active');
                    resultSec.style.display = 'block';
                    progressSec.style.display = 'none';
                    document.title = 'PDF to Scanned - âœ“ Conversion Complete';
                }, 500);
                
                const downloadButton = document.getElementById(`downloadBtn${suffix}`);
                downloadButton.onclick = () => {
                    const blob = new Blob([generatedPdfBytes], { type: 'application/pdf' });
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(blob);
                    link.download = currentFile.name.replace('.pdf', '_scanned.pdf');
                    link.click();
                    
                    document.title = 'PDF to Scanned - Downloaded';
                };

            } catch (err) {
                console.error(err);
                alert("Error: " + err.message);
                scanOverlay.classList.remove('active');
                convertButton.disabled = false;
                document.title = 'PDF to Scanned - Error';
            }
        }
    </script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"41342ae72cae4f17a1b1010d54e26477","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
</html>
