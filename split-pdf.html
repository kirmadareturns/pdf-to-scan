<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Split PDF - One Click Download All Pages</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
<style>
body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
.container { max-width: 600px; margin: auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);}
button, input { margin-top: 10px; display: block; padding: 10px; }
#progress { margin-top: 10px; color: #555; }
</style>
</head>
<body>
<div class="container">
<h2>Split PDF - Download All Pages</h2>
<input type="file" id="fileInput" accept="application/pdf">
<button id="splitBtn" disabled>Download All Pages</button>
<p id="progress"></p>
</div>

<script>
const fileInput = document.getElementById("fileInput");
const splitBtn = document.getElementById("splitBtn");
const progressText = document.getElementById("progress");
let pdfFile;

fileInput.addEventListener("change", () => {
    pdfFile = fileInput.files[0];
    splitBtn.disabled = !pdfFile;
});

splitBtn.addEventListener("click", async () => {
    if(!pdfFile) return;
    progressText.textContent = "Loading PDF...";
    const arrayBuffer = await pdfFile.arrayBuffer();
    const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
    const totalPages = pdfDoc.getPageCount();

    for(let i=0; i<totalPages; i++){
        const newPdf = await PDFLib.PDFDocument.create();
        const [page] = await newPdf.copyPages(pdfDoc,[i]);
        newPdf.addPage(page);

        const pdfBytes = await newPdf.save();
        const blob = new Blob([pdfBytes], {type: "application/pdf"});
        const url = URL.createObjectURL(blob);

        const a = document.createElement("a");
        a.href = url;
        a.download = `page_${i+1}.pdf`;
        a.click();

        progressText.textContent = `Downloaded page ${i+1} of ${totalPages}`;
        await new Promise(r => setTimeout(r, 50)); // small delay to avoid browser blocking
    }

    progressText.textContent = "All pages downloaded!";
});
</script>
</body>
</html>
