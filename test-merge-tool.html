<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Merge Tool</title>
</head>
<body>
    <h1>Automated Test for Merge Tool</h1>
    <div id="test-results"></div>
    
    <script>
        // Test data
        const testHTML = `<div class="container">
    <h1>Hello World</h1>
    <p>This is a test paragraph.</p>
</div>`;

        const testCSS = `body {
    font-family: Arial, sans-serif;
    background: #f0f0f0;
}
.container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
}`;

        const testJS = `console.log('Test JavaScript loaded');
document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM fully loaded');
});`;

        // Open the merge tool
        const mergeToolWindow = window.open('/merge-html-css-js.html', '_blank');
        
        // Wait for it to load, then inject test content
        setTimeout(() => {
            if (mergeToolWindow && !mergeToolWindow.closed) {
                try {
                    // Inject test content
                    mergeToolWindow.document.getElementById('html-input').value = testHTML;
                    mergeToolWindow.document.getElementById('css-input').value = testCSS;
                    mergeToolWindow.document.getElementById('js-input').value = testJS;
                    
                    // Update stats
                    mergeToolWindow.updateStats('html');
                    mergeToolWindow.updateStats('css');
                    mergeToolWindow.updateStats('js');
                    
                    // Test merge function
                    setTimeout(() => {
                        mergeToolWindow.mergeFiles();
                        
                        // Check if merge was successful
                        setTimeout(() => {
                            const outputSection = mergeToolWindow.document.getElementById('output-section');
                            const hasOutput = outputSection.classList.contains('show');
                            
                            document.getElementById('test-results').innerHTML = `
                                <h2>Test Results:</h2>
                                <p>HTML Input Length: ${mergeToolWindow.document.getElementById('html-input').value.length}</p>
                                <p>CSS Input Length: ${mergeToolWindow.document.getElementById('css-input').value.length}</p>
                                <p>JS Input Length: ${mergeToolWindow.document.getElementById('js-input').value.length}</p>
                                <p>Output Section Visible: ${hasOutput ? '✅ YES' : '❌ NO'}</p>
                                <p>Merged Content Generated: ${mergeToolWindow.mergedContent ? '✅ YES' : '❌ NO'}</p>
                            `;
                            
                            console.log('Test completed successfully');
                        }, 500);
                    }, 500);
                } catch (error) {
                    console.error('Test error:', error);
                    document.getElementById('test-results').innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
                }
            } else {
                document.getElementById('test-results').innerHTML = '<p style="color: red;">Failed to open merge tool window</p>';
            }
        }, 1000);
    </script>
</body>
</html>
